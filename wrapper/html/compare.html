<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Compare Page</title>
    <link rel="stylesheet" href="../css/jk.css"/>
    <link rel="stylesheet" href="../css/compare-page.css"/>
    <script src="../js/libs/jquery/jquery.js"></script>
    <script type="text/javascript">
        $(function() {
            var $grid = $('#grid'),
                $propertiesTable = $('#properties table'),
                $productTable    = $('#products table');

            function changeBarMargins () {
                var vertical = $grid.scrollTop();
                var horizontal = $grid.scrollLeft();
                $propertiesTable.css('margin-top', -vertical);
                $productTable.css('margin-left', -horizontal);
            }

            var scrolled = false;
            $grid.scroll(function() {
                scrolled = true;
            });
            setInterval(function() {
                if (scrolled) {
                    changeBarMargins();
                    scrolled = false;
                }
            }, 30);

            /**
             * That would be awesome if we could write a custom
             * jQuery selector for selecting a column of products
             * or a row of properties
             */
            //sizing effect
            $(document).ready(function () {
                //set tr rows in properties table
                var $propertyRows = $('#properties tr');
                $('#grid tr').each(function (index) {
                    var height = $(this).css('height')
                    //stupid firefox bug fix
                    $propertyRows.eq(index).
                            css('height', height)
                    $(this).css('height', height);
                });
            });

            //toggle effect
            $('#properties').delegate('.heading div ', 'click', function () {
                var index = $(this).parents('tbody').
                            index(),
                    $icon = $(this).find('.state');

                $(this).parents('tbody').
                        children('tr').
                        not('.heading').
                        slideToggle(1);

                if ( $icon.hasClass('open') ) {
                    $icon.
                        removeClass('open fa-caret-down').
                        addClass('close fa-caret-left');
                } else {
                    $icon.
                            removeClass('close fa-caret-left').
                            addClass('open fa-caret-down');
                }

                $('#grid tbody').eq(index).
                        children('tr').
                        not('.space').
                        slideToggle(1);
            });

            //horizontal highlight effect
            $('#properties, #grid').delegate('tr', 'mouseover mouseout', function (e) {
                var $el = $(e.target).parents('tr'),
                    index;
                if ($el.parents('#properties').length) {
                    index = $el.index('#properties tr');
                } else {
                    index = $el.index('#grid tr');
                }

                if (e.type == 'mouseover') {
                    $('#grid tr').eq(index).addClass('highlight');
                    $('#properties tr').eq(index).addClass('highlight');
                } else {
                    $('#grid tr').eq(index).removeClass('highlight');
                    $('#properties tr').eq(index).removeClass('highlight');
                }
            });

            //vertical highlight effect
            $('#products').delegate('td', 'mouseover mouseout', function (e) {
                var $el = $(e.target),
                    index = $el.parent('td').index();

                if (e.type == 'mouseover') {
                    $('#grid td').filter(function(){
                        return $(this).index() == index;
                    }).addClass('highlight');
                } else {
                    $('#grid td').filter(function(){
                        return $(this).index() == index;
                    }).removeClass('highlight');
                }

            });


            //remove effect
            $('#products').delegate('td .remove', 'click', function (e) {
                var $el = $(e.target);
                var index = $el.parents('td').index();
                var removeCollection = [];

                var trash = [];
                //find related tds in grid and hide them
                $('#grid td').each(function (i) {
                    if ( $(this).index() == index ) {
                        trash[i] = this;
                    }
                });
                //hide the product td itself
                trash.push($el.parents('td'));

                for(var i = 0; i < trash.length; i++) {
                    $(trash[i]).remove();
                }
                updateControlView();
            });

            var updateControlView = function () {
                $('.move-left,.move-right').show();
                $('.move-left:first').hide();
                $('.move-right:last').hide();
            };

            //move effetc
            $(document).ready(function () {
                updateControlView();
            });

            $('#products').delegate('.move-right,.move-left', 'click', function (e) {
                var $el = $(e.target),
                    index = $el.
                            parents('td').
                            index();
                
                if ($el.hasClass('move-right')) {
                    /**
                     *  we need a move function
                     */
                    //move the product
                    $el.parents('td').insertAfter($('#products td').eq(index + 1));

                    //move the grid
                    var col = [];
                    $('#grid td').each(function () {
                        if ( $(this).index() == index ) {
                            col.push(this);
                        }
                    });
                    for (var i = 0; i < col.length; i++) {
                        $(col[i]).insertAfter( $(col[i]).next() );
                    }

                } else {
                    /**
                     *  we need a move function
                     */
                    //move the product
                    $el.parents('td').insertBefore($('#products td').eq(index - 1));

                    //move the grid
                    var col = [];
                    $('#grid td').each(function () {
                        if ( $(this).index() == index ) {
                            col.push(this);
                        }
                    });
                    for (var i = 0; i < col.length; i++) {
                        $(col[i]).insertBefore( $(col[i]).prev() );   //bugs when moving second td to left
                    }
                }
                updateControlView();
            });

        });
    </script>
</head>
<body>

<div id="compare-wrapper">

<div id="corner">
    <div>
        <a href="#">More...</a>
    </div>
</div>

<div id="products">
    <table>
        <tbody>
        <tr>
            <td>
                <div class="product-ico">1
                    <i class="fa fa-trash-o remove control"></i>
                    <i class="fa fa-arrow-left move-left control" data-role="move-left"></i>
                    <i class="fa  fa-arrow-right move-right control" data-role="move-right"></i>
                </div>
            </td>
            <td>
                <div class="product-ico">2
                    <i class="fa fa-trash-o remove control"></i>
                    <i class="fa fa-arrow-left move-left control" data-role="move-left"></i>
                    <i class="fa  fa-arrow-right move-right control" data-role="move-right"></i>
                </div>
            </td>
            <td>
                <div class="product-ico">3
                    <i class="fa fa-trash-o remove control"></i>
                    <i class="fa fa-arrow-left move-left control" data-role="move-left"></i>
                    <i class="fa  fa-arrow-right move-right control" data-role="move-right"></i>
                </div>
            </td>
            <td>
                <div class="product-ico">4
                    <i class="fa fa-trash-o remove control"></i>
                    <i class="fa fa-arrow-left move-left control" data-role="move-left"></i>
                    <i class="fa  fa-arrow-right move-right control" data-role="move-right"></i>
                </div>
            </td>
            <td>
                <div class="product-ico">5
                    <i class="fa fa-trash-o remove control"></i>
                    <i class="fa fa-arrow-left move-left control" data-role="move-left"></i>
                    <i class="fa  fa-arrow-right move-right control" data-role="move-right"></i>
                </div>
            </td>
            <td>
                <div class="product-ico">6
                    <i class="fa fa-trash-o remove control"></i>
                    <i class="fa fa-arrow-left move-left control" data-role="move-left"></i>
                    <i class="fa  fa-arrow-right move-right control" data-role="move-right"></i>
                </div>
            </td>
            <td>
                <div class="product-ico">7
                    <i class="fa fa-trash-o remove control"></i>
                    <i class="fa fa-arrow-left move-left control" data-role="move-left"></i>
                    <i class="fa  fa-arrow-right move-right control" data-role="move-right"></i>
                </div>
            </td>
            <td>
                <div class="product-ico">8
                    <i class="fa fa-trash-o remove control"></i>
                    <i class="fa fa-arrow-left move-left control" data-role="move-left"></i>
                    <i class="fa  fa-arrow-right move-right control" data-role="move-right"></i>
                </div>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div id="properties">
    <table>
        <tbody>
        <tr class="heading">
            <td>
                <div><i class="state fa open fa-caret-down"></i>گروه</div>
            </td>
        </tr>
        <tr>
            <td>
                <div>ویژگی</div>
            </td>
        </tr>
        <tr>
            <td>
                <div>ویژگی</div>
            </td>
        </tr>
        <tr>
            <td>
                <div>ویژگی</div>
            </td>
        </tr>
        </tbody>
        <tbody>
        <tr class="heading">
            <td>
                <div><i class="state fa open fa-caret-down"></i>گروه</div>
            </td>
        </tr>
        <tr>
            <td>
                <div>ویژگی</div>
            </td>
        </tr>
        <tr>
            <td>
                <div>ویژگی</div>
            </td>
        </tr>
        <tr>
            <td>
                <div>ویژگی</div>
            </td>
        </tr>
        </tbody>
        <tbody>
        <tr class="heading">
            <td>
                <div><i class="state fa open fa-caret-down"></i>گروه</div>
            </td>
        </tr>
        <tr>
            <td>
                <div>ویژگی</div>
            </td>
        </tr>
        <tr>
            <td>
                <div>ویژگی</div>
            </td>
        </tr>
        <tr>
            <td>
                <div>ویژگی</div>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div id="grid">
    <table>
        <tbody>
        <tr class="space">
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
        </tr>
        <tr>
            <td>
                <div>
                    too much contetn
                    too much contetn
                    too much contetn
                    too much contetn
                    too much contetn
                    too much contetn
                    too much contetn
                </div>
            </td>
            <td>
                <div>2</div>
            </td>
            <td>
                <div>3</div>
            </td>
            <td>
                <div>4</div>
            </td>
            <td>
                <div>5</div>
            </td>
            <td>
                <div>6</div>
            </td>
            <td>
                <div>7</div>
            </td>
            <td>
                <div>8</div>
            </td>
        </tr>
        <tr>
            <td>
                <div>FF FF FF</div>
            </td>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>SS</div>
            </td>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
        </tr>
        <tr>
            <td>
                <div>FF FF FF</div>
            </td>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>SS</div>
            </td>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
        </tr>
        </tbody>
        <tbody>
        <tr class="space">
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
        </tr>
        <tr>
            <td>
                <div>v1</div>
            </td>
            <td>
                <div>v1</div>
            </td>
            <td>
                <div>v1</div>
            </td>
            <td>
                <div>v1</div>
            </td>
            <td>
                <div>v1</div>
            </td>
            <td>
                <div>v1</div>
            </td>
            <td>
                <div>v1</div>
            </td>
            <td>
                <div>v1</div>
            </td>
        </tr>
        <tr>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
        </tr>
        <tr>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
        </tr>
        </tbody>
        <tbody>
        <tr class="space">
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
            <td>
                <div></div>
            </td>
        </tr>
        <tr>
            <td>
                <div>v1</div>
            </td>
            <td>
                <div>v1</div>
            </td>
            <td>
                <div>v1</div>
            </td>
            <td>
                <div>v1</div>
            </td>
            <td>
                <div>v1</div>
            </td>
            <td>
                <div>v1</div>
            </td>
            <td>
                <div>v1</div>
            </td>
            <td>
                <div>v1</div>
            </td>
        </tr>
        <tr>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
            <td>
                <div>v2</div>
            </td>
        </tr>
        <tr>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
            <td>
                <div>v3</div>
            </td>
        </tr>
        </tbody>
    </table>
</div>

</div>
</body>
</html>